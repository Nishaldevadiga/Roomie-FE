<div class="room-view-container">
    <!-- Back button -->
    <button class="back-btn" (click)="goBack()">
      <i class="fas fa-arrow-left"></i> Back to Rooms
    </button>
  
    <!-- Loading state -->
    <div *ngIf="loading" class="loading">
      <p>Loading room details...</p>
    </div>
    
    <!-- Error message -->
    <div *ngIf="error" class="error-message">
      <p>{{ error }}</p>
    </div>
  
    <!-- Room details -->
    <div *ngIf="!loading && !error && room" class="room-details">
      <div class="room-header">
        <h1>{{ room.title }}</h1>
        <span class="price">${{ room.price }}/night</span>
      </div>
      
      <div class="room-body">
        <div class="main-info">
          <div class="location-info">
            <i class="fas fa-map-marker-alt"></i> {{ room.location }}
          </div>
          
          <div class="availability-tag" [class.available]="room.is_available" [class.unavailable]="!room.is_available">
            {{ room.is_available ? 'Available' : 'Not Available' }}
          </div>
          
          <p class="listing-date">Listed on: {{ formatDate(room.created_at) }}</p>
          
          <h3>Description</h3>
          <p class="description">{{ room.description }}</p>
        </div>
        
        <div class="provider-details">
          <h3>About the Provider</h3>
          <p><strong>Name:</strong> {{ room.provider.username }}</p>
          <p>{{ room.provider.bio }}</p>
          
          <div class="contact-section">
            <h3>Contact the Provider</h3>
            
            <!-- <div *ngIf="!isLoggedIn" class="login-prompt">
              <p>Please <a [routerLink]="['/login']" [queryParams]="{redirect: '/roomview/' + roomId}">log in</a> to contact the provider.</p>
            </div> -->
            
            <div *ngIf="isLoggedIn">
              <div *ngIf="contactStatus === 'initial' || contactStatus === 'error'">
                <p *ngIf="room.is_available">Interested in this room? Contact the provider to learn more or make a booking.</p>
                <p *ngIf="!room.is_available" class="unavailable-message">This room is currently not available for booking.</p>
                
                <button 
                  class="contact-btn" 
                  [disabled]="!room.is_available || contactStatus === 'processing'" 
                  (click)="contactProvider()">
                  Contact Provider
                </button>
                
                <p *ngIf="contactError" class="error-text">{{ contactError }}</p>
              </div>
              
              <div *ngIf="contactStatus === 'processing'" class="processing">
                <p>Sending your request...</p>
              </div>
              
              <div *ngIf="contactStatus === 'success'" class="success-message">
                <p>Your contact request has been sent! The provider will get back to you soon.</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>